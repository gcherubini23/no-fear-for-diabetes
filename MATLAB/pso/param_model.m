%% Comparing to GT
if ~use_true_patient
    % % Best using MSE
    % p = [0.00542767432046846,	0.406509811384502,	0.500000000000000,	4.48796062636850,	0.00480323418050043,	0.000104733132703769,	0.0934117134735254,	0.00934850839462120,	0.0977611506438287,	0.0265190704919319,	0.0352422437487089]; % BEST
    % p = [0.00692969041535363,	0.221175855482405,	0.289354129999467,
    % 4.88915947935168,	0.00443847724112982,	0.000100000000000000,
    % 0.0783288398117539,	0.00758782832475949,	0.0990034968223399,
    % 0.0293280078067010,	0.0313402517781819]; % BEST using longer experiment
    
    % % Best using RMSE
    % p = [0.00867171835016086,	0.394605478835008,	0.499442578412629,	5.95546142920697,	0.00428850132999850,	0.000913071382032137,	0.0997867581817115,	0.00703582396230473,	0.0961175442588771,	0.0386044391603998,	0.0224839553944235];
    
    % Comparing to CGM
    % Best using MSE
    % p = [0.000790653343271446,	0.405640265724335,	0.490795840246288,	5.42022112811144,	0.00436200018973209,	0.000828901354548169,	0.100000000000000,	0.00796998392872804,	0.0950721054238413,	0.0270949155469932,	0.0317580189853282]; % BEST
    
    % Best using logMSE
    % p = [0.00146357466634368,	0.218798034701857,	0.332790084881620,	4.46551510843811,	0.00539047403268261,	0.000107668440747057,	0.0203292704426594,	0.00580387922110643,	0.100000000000000,	0.0290688859079165,	0.0319965142022406];
    
    % Best using log-likelihood
    % p = [0.00701668087717302,	0.369162325140569,	0.484425825956220,	4.88463681499870,	0.00440027384718579,	0.000188360321539952,	0.0928464063965499,	0.00767504547844108,	0.0876475567984728,	0.0293042078281975,	0.0313281318108638]; % BEST
    
    % p = [0.00716998351386864,	0.390062188468490,	0.482703397483656,	4.83804721507048,	0.00452135095508243,	0.000899234025720681,	0.0955592571364963,	0.00807954101149883,	0.100000000000000,	0.0300281789239006,	0.0314811981490732];
    % 
    % params = params.set_params({'kp2','k1','k2','kp1','ki','ke1','kmax','kmin','kabs','kp3','Vmx'}, p);
    
    

    %    kp2,                   k1,                     k2,                 kp1,                    ki,                     ke1,                    kmax,               kmin,               kabs,                   kp3,                Vmx,                Gb
    % 
    % p = [0.00627984690700475,	0.273317762642556,	0.370499484862642,	4.64478309221182,	0.00451523454939320,	0.000328020658339412,	0.0886392094261030,	0.00747315367504439,	0.0948721699886073,	0.0276480508914665,	0.0323549128391175,	136.359246268003];
    % params = params.set_params({'kp2','k1','k2','kp1','ki','ke1','kmax','kmin','kabs','kp3','Vmx','Gb'}, p);

    % p = [0.00627984690700475,	0.273317762642556,	0.370499484862642,	4.64478309221182,	0.00451523454939320,	0.000328020658339412,	0.0276480508914665,	0.0323549128391175,	136.359246268003];
    % params = params.set_params({'kp2','k1','k2','kp1','ki','ke1','kp3','Vmx','Gb'}, p);

    
    % p = [1.97097368987751	0.382588129057394	1.48623099040202	0.0277853704446429	0.0971700740193925	295.553591491183	0.0968806194157534	0.000436296006596258	0.0947691760840190	0.00995916918342251	0.121777932848213	0.00650887272818763];
    % p = [1.95716257231475	0.303232724239480	1.03812683627563	0.0977890218909042	0.0144118450436362	203.497052384701	0.172689602174614	0.00213478230306880	0.0318435205311254	0.00674933803403032	0.281903993849765	0.00768140019683277];
    % params = params.set_params({'VG','m1','CL','Vmx','k1','Km0','k2','kp2','kmax','kmin','kabs','ki'}, p);

    p = [0.00142388838241995	0.0280856347005609	0.0322104429145688	3.03419177956619	0.00897761097253843	0.00228183054439790	0.0491656370275355	0.00618827472136074	0.0871586250327557	0.0249257076331734	0.0294401268034101];
    params = params.set_params({'kp2','k1','k2','kp1','ki','ke1','kmax','kmin','kabs','kp3','Vmx'}, p);

    
    % p = [0.0111891067073364	0.915135743188441	0.746238174107314	6	0.00435593158947141	0.0121154435241097	0.0137862774662869	0.596421631880651	0.856000798843149	0.0373508019980042	0.0277469974217360];
    % params = params.set_params({'kp2','k1','k2','kp1','ki','ke1','kmax','kmin','kabs','kp3','Vmx'}, p);
end

%% True patient 11

if use_true_patient

    if use_anderson

        if patient_ID == 11

                %    kp2,                   k1,                     k2,                 kp1,                    ki,                     ke1,                kmax,               kmin,                   kabs,                kp3,                   Vmx,                Gb
       
        % p = [0.000245204696755482	0.163713738369110	0.410648885415257	2.00165899312716	0.00977916694913411	0.000918247722488434	0.0235372250594031	0.00872644702940938	0.0802486432950807	0.000100000000000000	0.090842953090022	0.205527857193382	0.977473918049344	0.113842688502727];
        % params = params.set_params({'kp2','k1','k2','kp1','ki','ke1','kmax','kmin','kabs','kp3','Vmx','m1','m2','m4'}, p);
    
    
         
        % p = [0.000400344028885590	0.142092041596851	0.499984208119427	2.17075139930189	0.0100000000000000	0.0536539517900893	0.0199476315751554	0.0104316359349439	0.0999383947926862	0.402876232493511	0.466556696632950	0.341303626118757];     
        % params = params.set_params({'kp2','k1','k2','kp1','ki','kmax','kmin','kabs','Vmx','m1','m2','m4'}, p); % error when using measurement update
    
    
         % p = [1.50000000000000	0.126609720858633	0.896825747207413	0.0723480142696808	0.0426650133382422	248.688709115695	0.167943508647782	0.00595668686504072	0.0100036162311378	0.00599930660697135	0.0513932730717355];
         % params = params.set_params({'VG','m1','CL','Vmx','k1','Km0','k2','kp2','kmax','kmin','kabs'}, p);
    
         % p = [1.50000000000000	0.286795880673270	1.50000000000000	0.0835344342935767	0.0405136394183627	292.407348272287	0.199090401603865	0.00327025449239186	0.00673656254367116	0.00679990028458571	0.0543535895699095	0.00997080700520247];
         % params = params.set_params({'VG','m1','CL','Vmx','k1','Km0','k2','kp2','kmax','kmin','kabs'}, p);
    
    
         % p = [1.50000000000000	0.286795880673270	1.50000000000000	0.0835344342935767	0.0405136394183627	292.407348272287	0.199090401603865	0.00327025449239186	0.00673656254367116	0.00679990028458571	0.0543535895699095	0.00997080700520247];
         % params =  params.set_params({'VG','m1','CL','Vmx','k1','Km0','k2','kp2','kmax','kmin','kabs','ki'}, p);
    
         % p = [1.50007508425626	0.397250876023399	1.49995428715290	0.0988417292757989	0.0231675320588557	200	0.199517660345252	0.00805544730084602	0.00773427008182499	0.00528878822454568	0.296926850632158	0.00999864583221703];
         % params = params.set_params({'VG','m1','CL','Vmx','k1','Km0','k2','kp2','kmax','kmin','kabs','ki'}, p);
    
         % p = [1.51930620965619	0.130527907000000	0.501207219008352	0.0415520585104284	0.0503161390524398	211.178123641455	0.143404051811436	0.000156129717100404	0.00769337157127183	0.00628594193881942	0.0648800727368820	0.00999279521792938	0.451868885592570];
         % params = params.set_params({'VG','m1','CL','Vmx','k1','Km0','k2','kp2','kmax','kmin','kabs','ki','u2ss'}, p);


        p = [0.00699855426374204	0.0430431546209121	0.398476023416746	1.94617204130849	1.00000000000000e-05	0.0124532521453412	0.0392729507649691	0.0582413062710724	0.00629790588923260	1.00000000000000e-05	0.209842980308945];
        params = params.set_params({'kp2','k1','k2','kp1','ke1','kmax','kmin', 'kgri','kabs','kp3','Vmx'}, p);
        end

        if patient_ID == 17
            % p = [1.99999675759867	0.397817947807300	1.50000000000000	0.0999416778642028	0.0100004785726379	300	0.199994301068677	0.00251429780584819	0.0133863719548739	0.00175663037962863	0.300000000000000];
            % p = [1.99997604566632	0.386300458054730	1.50000000000000	0.0591939233400531	0.0100044504129369	300	0.199969316332053	0.000100000000000000	0.0154578198347359	0.00174612055042329	0.300000000000000];
            % params = params.set_params({'VG','m1','CL','Vmx','k1','Km0','k2','kp2','kmax','kmin','kabs'}, p);
        


            % p = [0.0463151386139017	0.00850370689850918	0.00217204346863193	6	0.0124838977320622	1.00000000000000e-05	0.131405836603298	0.201301739455772	0.00364350133515147	1.00000000000000e-05	0.161006468573114];
            % params = params.set_params({'kp2','k1','k2','kp1','ke1','kmax','kmin', 'kgri','kabs','kp3','Vmx'}, p);



            p = [0.00499027344446903	4.77351115092225	0.00678620955008476	1.00000000000000e-05	0.0329961574486569	1.00000000000000e-05];
            params = params.set_params({'kp2','kp1','ki','ke1','kp3','Vmx'}, p);
        
        end



    end

    if use_tmoore
        % p = [2.65565440901474	0.649430243127675	3	0.00918951553502747	0.190116930370657	100	0.0250000000000000	0.00708837537237668	0.115296002949592	0.0200000000000000	0.0391769477649835	0.00200000000000000];
        % params = params.set_params({'VG','m1','CL','Vmx','k1','Km0','k2','kp2','kmax','kmin','kabs','ki'}, p);
     
        p = [1.50000000000000	0.399808524339688	1.50000000000000	0.0999913629537717	0.0146629675849774	200.003945291855	0.199668784611321	0.0100000000000000	0.00173116215659319	0.0100000000000000	0.300000000000000	0.00400000000000000	0.100000000000000];
        params = params.set_params({'VG','m1','CL','Vmx','k1','Km0','k2','kp2','kmax','kmin','kabs','ki','u2ss'}, p);
    
    end

    if use_shanghai
        if patient_ID == 1007
            p = [0.000165177452227904	0.0272022659129592	0.014427888711385	2.71420308225136	0.0104530747227785	1	0.0567647966896068	0.130379185678025	0.0261874493041442	0.0262491594641587	1.00000000000000e-05	1.93586988140253];
            params = params.set_params({'kp2','k1','k2','kp1','ki','ke1','kmax','kmin','kabs','kp3','Vmx','VG'}, p);

            % p = [0.0286216133026989	0.00821610437289417	0.000178806562253576	6	0.000287616376199055	0.281305786740562	0.00225241566656545	1	0.0393831522310934	0.0864613072938534	0.227259141040084];
            % params = params.set_params({'kp2','k1','k2','kp1','ke1','kmax','kmin', 'kgri','kabs','kp3','Vmx'}, p);

            % p = [0.00454426005719953	0.00154281342913677	1	1.72621557678894	0.00504531149754731	0.000500000000000000	0.0457286914335321	0.000373505839527540	0.00300167203992036	0.0106301750260069	0.00127114565303802];
            % params = params.set_params({'kp2','k1','k2','kp1','ke1','kmax','kmin', 'kgri','kabs','kp3','Vmx'}, p);
            % 
            % p = [1.00000000000000e-05	2.28306200392377	0.00843164022062208	0.000500000000000000	0.163995429750905	0.210223703553112	0.00290254495338659	0.00672318515678398	1.00000000000000e-05];
            % params = params.set_params({'kp2','kp1','ke1','kmax','kmin', 'kgri','kabs','kp3','Vmx'}, p);


            % p = [0.0160401217083955	2.75283000510846	1.00000000000000e-05	0.000500000000000000	1.00000000000000e-05	1.00000000000000e-05];
            % params = params.set_params({'kp2','kp1','ki','ke1','kp3','Vmx'}, p);
        end

        if patient_ID == 1002
            % p = [0.0176553540787431	0.148760818269538	1	6	0.00721792557853543	1	0.125241211983798	0.0196931318796094	0.0252920489257595	0.0187552276526636	0.557010182947336	2.84711585647146];
            % params = params.set_params({'kp2','k1','k2','kp1','ki','ke1','kmax','kmin','kabs','kp3','Vmx','VG'}, p);
        
            p = [1.00000000000000e-05	6	0.00683702629198257	0.190076978580308	0.0190981901870210	1];
            params = params.set_params({'kp2','kp1','ki','ke1','kp3','Vmx'}, p);
        
        end

        if patient_ID == 1010
            p = [0.0469407068907540	0.235472471650335	1	2.69917883678794	1.00000000000000e-05	1	0.498307026956838	0.911108818575275	1.00000000000000e-05	1.00000000000000e-05	0.162261765274725];
            params = params.set_params({'kp2','k1','k2','kp1','ki','ke1','kmax','kmin','kabs','kp3','Vmx'}, p);
        end

    end
end



